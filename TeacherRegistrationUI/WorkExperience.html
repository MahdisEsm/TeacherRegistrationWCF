<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    <link href="Content/bootstrap-rtl.css" rel="stylesheet" />
    <script src="Scripts/jquery-3.0.0.min.js"></script>
    <script src="Scripts/bootstrap.bundle.js"></script>
    <link href="Content/font-awesome.css" rel="stylesheet" />
    <link href="Content/Css/SiteCss.css" rel="stylesheet" />
    <title>WorkExperience</title>
</head>
<body>
    <header class="d-felx justify-content-center">
        <nav class="navbar Sitenav w-75 mx-auto radius1rem shadow">
            <a class="navbar-brand font-weight-bold" href="#">
                <img src="Content/Image/logoYellow.png" width="70" height="70" class="d-inline-block align-center" alt="" loading="lazy">
                جذب مدرس دوره های تخصصی IT
            </a>
        </nav>
        <div class="w-75 mx-auto mt-3 text-center">
            <img src="Content/Image/FigmaProjectIcons/Person-blue.png" />
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <i class="fa fa-circle" style="font-size: 6px; color: #133889;"></i>
            <img src="Content/Image/FigmaProjectIcons/Education-Blue.png" />
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889;"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <i class="fa fa-circle" style="color: #133889; font-size: 6px"></i>
            <img src="Content/Image/FigmaProjectIcons/Job-Blue.png" />
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3;"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <img src="Content/Image/FigmaProjectIcons/Teacher.png" style="opacity: 0.2;" />
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3;"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <img src="Content/Image/FigmaProjectIcons/Document.png" style="opacity: 0.2;" />
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3;"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <i class="fa fa-circle text-black-50" style="opacity: 0.3; font-size: 6px"></i>
            <img src="Content/Image/FigmaProjectIcons/LikeToTeach.png" style="opacity: 0.2;" />
        </div>
    </header>

    <section class="radius1rem shadow d-felx justify-content-center w-50 mx-auto m-4 p-3">
        <div>
            <h5 class="text-secondary">سوابق شغلی </h5>
            <hr class="hr-leftFade" />
        </div>

        <form class="m-1 fontSmall12" id="form">
            <div id="rows" class="m-3">
                <div id="row1">
                    <div class="row">
                        <div class="col-md-12">
                            <p>ردیف <span id="rowNum1">1</span> : </p>
                        </div>
                        <div class="col-md-6">

                            <div class="form-group row">
                                <label for="CompanyName" class="col-md-4 col-form-label">نام شرکت:</label>
                                <div class="col-md-8 p-0">
                                    <input type="text" class="form-control form-control-sm rounded-lg" id="CompanyName1" name="CompanyName" />
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="companyAddress" class="col-md-4 col-form-label">محل شرکت:</label>
                                <div class="col-md-8 p-0">
                                    <input type="text" class="form-control form-control-sm rounded-lg" id="companyAddress1" name="companyAddress" />

                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="position" class="col-md-4 col-form-label">سمت:</label>
                                <div class="col-md-8 p-0">
                                    <input type="text" class="form-control form-control-sm rounded-lg" id="position" name="position">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="manager" class="col-md-4 col-form-label">نام مدیر مستقیم:</label>
                                <div class="col-md-8 p-0">
                                    <input type="text" class="form-control form-control-sm rounded-lg" id="manager1" name="manager" />
                                </div>
                            </div>

                        </div>

                        <div class="col-md-6">


                            <div class="form-group row">
                                <label for="fromDate" class="col-md-4 col-form-label">از تاریخ:</label>
                                <div class="col-md-8 p-0">
                                    <input type="date" class="form-control form-control-sm rounded-lg" id="fromDate1" name="fromDate">
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="toDate" class="col-md-4 col-form-label">تا تاریخ:</label>
                                <div class="col-md-8 p-0">
                                    <input type="date" class="form-control form-control-sm rounded-lg" id="toDate1" name="toDate">
                                </div>
                            </div>

                            <div class="form-group row">
                                <label for="companyPhone" class="col-md-4 col-form-label">تلفن شرکت:</label>
                                <div class="col-md-8 p-0">
                                    <input type="text" class="form-control form-control-sm rounded-lg" id="companyPhone1" name="companyPhone">
                                </div>
                            </div>

                        </div>

                        <div class="form-group row container-fluid">
                            <label for="responsibility" class="col-md-2 col-form-label">شرح وظایف:</label>
                            <div class="col-md-10 p-0">
                                <textarea class="form-control rounded-lg" id="duties1" name="duties">
                                        </textarea>
                            </div>
                        </div>


                    </div>
                    <hr class="hr-leftFade" />

                </div>
            </div>
            <div>
                <a id="addNewRow" class="btn btn-light btn-sm float-md-right">افزودن ردیف جدید <i class="fa fa-plus"></i></a>
            </div>
            <div>
                <a id="deleteLastRow" class="btn btn-light btn-sm float-md-left">حذف آخرین ردیف <i class="fa fa-minus"></i></a>
            </div>
            <br />
            <br />
              <br />
            <div class="row  d-flex justify-content-md-between" id="btnParent">
                <div class="col-md-2">
                    <button id="prevButton" class="btn btn-sm SematecTextYellow sematecBgBlue fontSmall12"><i class="fa fa-arrow-circle-o-right text-warning"></i>مرحله قبل </button>
                </div>
                <div class="col-md-2">
                    <button id="nextButton" class="btn btn-sm SematecTextYellow sematecBgBlue fontSmall12">مرحله بعد <i class="fa fa-arrow-circle-o-left text-warning"></i></button>
                </div>
            </div>



        </form>
    </section>
   
</body>
<script type="text/javascript">
     var getWorkExp;
    var queryString = decodeURIComponent(window.location.search);

    if (queryString != "") {
        queryString = queryString.substring(1);
        var queries = queryString.split("&");
        var personID = queries[0];
    }

    var rowid = 1;
    $("#addNewRow").click(function (e) {
        rowid = rowid + 1;
        debugger;
        var cln = $("#row1").clone();
        cln.attr('id', 'row' + rowid);
        $("#rows").append(cln);
        $("#row" + rowid + " " + "#rowNum1").html(rowid);
        $("#row" + rowid + " " + "#CompanyName1").attr('id', 'CompanyName' + rowid);
        $("#row" + rowid + " " + "#companyAddress1").attr('id', 'companyAddress' + rowid);
        $("#row" + rowid + " " + "#position1").attr('id', 'position' + rowid);
        $("#row" + rowid + " " + "#manager1").attr('id', 'manager' + rowid);
        $("#row" + rowid + " " + "#fromDate1").attr('id', 'fromDate' + rowid);
        $("#row" + rowid + " " + "#toDate1").attr('id', 'toDate' + rowid);
        $("#row" + rowid + " " + "#companyPhone1").attr('id', 'companyPhone' + rowid);
        $("#row" + rowid + " " + "#duties1").attr('id', 'duties' + rowid);
        $('#CompanyName' + rowid).val(' ');
        $('#companyPhone' + rowid).val(' ');
        $('#companyAddress' + rowid).val(' ');
        $('#position' + rowid).val(' ');
        $('#manager' + rowid).val(' ');
        $('#duties' + rowid).val(' ');
        $('#fromDate' + rowid).text(' ');
        $('#toDate' + rowid).text(' ');
        
    });
     $("#deleteLastRow").click(function (e) {
        debugger;
        if (rowid > 1) {
            $("#rows").find("#row" + rowid).remove();
            rowid = rowid - 1;
        }

    });
    //--------------------------loadData-----------------------------------------------------------------------
        $.get('http://localhost:60404/RegistrationService.svc/GetWorkExperience', { personID: personID })
        .done(function (data) {
            debugger;
            getWorkExp = data.GetWorkExperienceResult;
            for (var i = 0; i < data.GetWorkExperienceResult.length; i++) {
                if (i > 0) {
                    $("#addNewRow").trigger("click");
                }

                $('#CompanyName' + rowid).val(data.GetWorkExperienceResult[i].CompanyName);
                $('#companyPhone' + rowid).val(data.GetWorkExperienceResult[i].CompanyPhone);
                $('#companyAddress' + rowid).val(data.GetWorkExperienceResult[i].CompanyAddress);
                $('#position' + rowid).val(data.GetWorkExperienceResult[i].Position);
                $('#manager' + rowid).val(data.GetWorkExperienceResult[i].Manager);
                $('#duties' + rowid).val(data.GetWorkExperienceResult[i].Duties);
                $('#fromDate' + rowid).val(data.GetWorkExperienceResult[i].FromDate);
                $('#toDate' + rowid).val(data.GetWorkExperienceResult[i].ToDate);

            }

        });

    //-----------------------------------------------PrevButtonEvent------------------------
    $('#prevButton').click(function (e) {
        debugger;
        e.preventDefault();
        e.stopPropagation();
        location = '/EducationalExperience.html?' + personID;
    });
    //----------------------------------------SendToServer-------------------------------------

    $('#nextButton').click(function (e) {
        var error = 0;
        e.preventDefault();
        debugger;

        var workExps = [];
        for (var i = 1; i < rowid + 1; i++) {
            var WorkExp = {};
            WorkExp.ID = 0
            WorkExp.PersonID = personID;
            WorkExp.CompanyName = $('#CompanyName' + i).val();
            WorkExp.CompanyAddress = $('#companyAddress' + i).val();
            WorkExp.CompanyPhone = $('#companyPhone' + i).val();
            WorkExp.Manager = $('#manager' + i).val();
            WorkExp.Position = $('#position' + i).val();
            WorkExp.Duties = $('#duties' + i).val();
            WorkExp.FromDate = $('#fromDate' + i).val();
            WorkExp.ToDate = $('#toDate' + i).val();
            workExps.push(WorkExp);
        }
        //--------------delete OLD Data-----------------------------

        $.ajax({
            type: "GET",
            url: "http://localhost:60404/RegistrationService.svc/DeleteWorkExpByPersonID",
            data: { personID: personID },
            error: function (jqXHR, textStatus, errorMessage) {
                debugger;
                console.log(jqXHR + '     ' + textStatus + '    ' + errorMessage);
                alert("درخواست شما موفقیت آمیز نبود");
                error += 1;
                return;

            },
            success: function (data) {
                debugger;
                console.log(data);
                $.ajax({
                    type: "POST",
                    url: "http://localhost:60404/RegistrationService.svc/SubmitWorkExperience",
                    data: JSON.stringify({ workExps: workExps }),
                    contentType: "application/json",
                    dataType: "json",
                    error: function (jqXHR, textStatus, errorMessage) {
                        debugger;
                        console.log(jqXHR + '     ' + textStatus + '    ' + errorMessage);
                        alert("درخواست شما موفقیت آمیز نبود");
                        error += 1;
                        return;

                    },
                    success: function (data) {
                        debugger;
                        console.log(data);
                        if (error == 0) {
                            location = '/TeachingExperience.html?' + personID;
                        }
                    }

                });

            }

        });





    });



</script>



</html>
